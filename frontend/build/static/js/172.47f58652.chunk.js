"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[172,246],{172:function(e,s,a){a.r(s);var t=a(5671),i=a(3144),n=a(7326),l=a(136),r=a(8505),o=a(4569),d=a.n(o),h=a(2791),c=a(4412),u=a(1523),m=a(9271),x=a(3360),p=a(5246),g=(a(6171),a(3785)),f=a(184),v=function(e){(0,l.Z)(a,e);var s=(0,r.Z)(a);function a(e){var i;return(0,t.Z)(this,a),(i=s.call(this)).state={dates:[],sesions:[],dia:"0",modal:!1,expo:"",sessio:"",modal2:!1,reservat:1},i.toggleModal2=i.toggleModal2.bind((0,n.Z)(i)),i.handleChange=i.handleChange.bind((0,n.Z)(i)),i.toggleModal=i.toggleModal.bind((0,n.Z)(i)),i.handleSubmit=i.handleSubmit.bind((0,n.Z)(i)),i.handleSessio=i.handleSessio.bind((0,n.Z)(i)),i}return(0,i.Z)(a,[{key:"componentDidMount",value:function(){var e=this,s=this.props.match.params.idExpo;d().get("https://www.api.artgalleryxisca.me/dies/"+s).then((function(s){var a=s.data;e.setState({dates:a})})),d().get("https://www.api.artgalleryxisca.me/exposicio/"+s).then((function(s){var a=s.data;e.setState({expo:a})}))}},{key:"handleChange",value:function(e){var s=this;this.setState({dia:e.value});var a=this.props.match.params.idExpo,t=e.value;d().post("https://www.api.artgalleryxisca.me/sessions/"+a,{dia:t}).then((function(e){var a=e.data;s.setState({sesions:a})}))}},{key:"toggleModal",value:function(){this.setState({modal:!this.state.modal})}},{key:"toggleModal2",value:function(){this.setState({modal2:!this.state.modal2})}},{key:"handleSessio",value:function(e){this.setState({sessio:e}),this.toggleModal()}},{key:"handleSubmit",value:function(){var e=this,s=this.state.sessio.id_sessio,a=this.props.user.id_usuaris;d().post("https://www.api.artgalleryxisca.me/reserva",null,{params:{id_sessio:s,id_usuari:a}}).then((function(s){e.setState({reservat:s.data})})),this.toggleModal(),this.toggleModal2()}},{key:"render",value:function(){var e,s,a=this;return 0===this.state.sesions.length&&(e=(0,f.jsx)("p",{className:"mt-2 text-white",children:"No hi ha cap sessi\xf3 assignada per aquest dia."})),1===this.state.reservat&&(s=(0,f.jsx)(c.fe,{children:"S'ha reservat correctament"})),0===this.state.reservat&&(s=(0,f.jsx)(c.fe,{children:"La sessi\xf3 seleccionada est\xe0 plena. Perfavor seleccioni una altra sessi\xf3."})),(0,f.jsxs)(c.W2,{children:[(0,f.jsx)("h3",{className:"mt-3",children:"Reserva la teva entrada"}),(0,f.jsxs)(c.X2,{children:[(0,f.jsx)(c.JX,{lg:"2",children:(0,f.jsx)("div",{children:(0,f.jsx)(p.default,{id:this.props.match.params.idExpo})})}),(0,f.jsxs)(c.JX,{lg:"9",className:"mt-5",children:[(0,f.jsx)("h5",{children:this.state.expo.nom}),(0,f.jsx)("p",{children:this.state.expo.descripcio})]})]}),(0,f.jsxs)(c.X2,{className:"mb-5",children:[(0,f.jsxs)(c.JX,{lg:"4",sm:"12",className:"mt-3",children:[(0,f.jsx)("span",{children:"Tria el dia en el que vols reservar:"}),(0,f.jsx)(g.Datepicker,{controls:["calendar"],value:this.state.dia,dateFormat:"DD-MM-YYYY",firstDay:1,returnFormat:"iso8601",min:this.state.dates.data_ini,max:this.state.dates.data_fi,locale:g.localeCa,onChange:this.handleChange})]}),(0,f.jsxs)(c.JX,{lg:"8",sm:"12",className:"mt-3",children:[(0,f.jsx)("span",{children:"Tria la sessi\xf3:"}),(0,f.jsx)(c.W2,{style:{backgroundColor:"#1a1a1a",borderRadius:"10px"},className:"bg-dark shadow-lg border border-dark d-flex flex-wrap justify-content-start m-3 p-3",children:(0,f.jsxs)(c.X2,{children:[e,this.state.sesions.map((function(e){return(0,f.jsx)(c.JX,{lg:"3",xs:"3",className:"d-flex justify-content-center",children:(0,f.jsxs)(x.Z,{className:"w-100 my-2 d-flex flex-wrap justify-content-center",value:e.id_sessio,variant:"outline-light",onClick:function(){return a.handleSessio(e)},children:[(0,f.jsxs)("p",{className:"pe-0 fw-bold",children:[e.hora_ini.slice(0,-3)," - ",e.hora_fi.slice(0,-3)]}),(0,f.jsx)("span",{style:{fontSize:"12px",width:"100%"},children:e.nom})]})},e.id_sessio)}))]})})]})]}),(0,f.jsxs)(c.u_,{isOpen:this.state.modal,toggle:this.toggleModal,children:[(0,f.jsx)(c.xB,{toggle:this.toggleModal,children:"Confirmaci\xf3 de la reserva: "}),(0,f.jsxs)(c.l0,{onSubmit:this.handleSubmit,children:[(0,f.jsxs)(c.fe,{children:[(0,f.jsx)("h6",{children:"Informaci\xf3 de la reserva:"}),(0,f.jsxs)("p",{children:["Nom de la exposici\xf3 reservada: ",(0,f.jsx)("span",{className:"fw-bold",children:this.state.expo.nom})," "]}),(0,f.jsxs)("p",{children:["Podr\xe0 entrar al recinte a la sessi\xf3 ",(0,f.jsx)("span",{className:"fw-bold",children:this.state.sessio.nom})," el dia ",this.state.dia,": "]}),(0,f.jsxs)("span",{className:"fw-bold",children:[this.state.sessio.hora_ini," - ",this.state.sessio.hora_fi]})]}),(0,f.jsxs)(c.mz,{children:[(0,f.jsx)(x.Z,{variant:"dark",onClick:this.handleSubmit,children:"Reserva"}),(0,f.jsx)(x.Z,{variant:"secondary",onClick:this.toggleModal,children:"Cancela"})]})]})]}),(0,f.jsxs)(c.u_,{isOpen:this.state.modal2,children:[(0,f.jsx)(c.xB,{children:"Informaci\xf3 de la reserva:"}),s,(0,f.jsxs)(c.mz,{children:[(0,f.jsx)(x.Z,{variant:"dark",onClick:this.handleSubmit,children:(0,f.jsx)(u.rU,{className:"text-decoration-none text-white",to:"/",children:"Torna a l'inici"})}),(0,f.jsx)(x.Z,{variant:"secondary",onClick:this.toggleModal2,children:"Cancela"})]})]})]})}}]),a}(h.Component);s.default=(0,m.EN)(v)},5246:function(e,s,a){a.r(s);var t=a(5671),i=a(3144),n=a(136),l=a(8505),r=a(2791),o=a(4569),d=a.n(o),h=a(184),c=function(e){(0,n.Z)(a,e);var s=(0,l.Z)(a);function a(e){var i;return(0,t.Z)(this,a),(i=s.call(this,e)).state={obra:[]},i}return(0,i.Z)(a,[{key:"componentDidMount",value:function(){var e=this;d().get("https://www.api.artgalleryxisca.me/exposicions/"+this.props.id+"/primeraObra").then((function(s){var a=s.data;e.setState({obra:a})}))}},{key:"render",value:function(){return(0,h.jsx)("img",{className:"img-fluid rounded-start ",src:"https://www.api.artgalleryxisca.me/fotos/"+this.state.obra.id_obres,style:{height:300,objectFit:"cover"},alt:this.state.obra.nom})}}]),a}(r.Component);s.default=c}}]);
//# sourceMappingURL=172.47f58652.chunk.js.map